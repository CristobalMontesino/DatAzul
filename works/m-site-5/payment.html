<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>WebTemplate5</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="css/stylesheet.css">
	<link rel="stylesheet" href="css/responsive.css">
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/swiper-bundle.min.css">
	<script type="text/javascript" src="js/jquery-3.5.1.slim.min.js"></script>
	<script type="text/javascript" src="js/bootstrap.min.js"></script>
</head>

<body>
	<div id="top" class="top-nav-bar">
		<div class="search-box text-center">
			<p>
				<a href="#top">
					WebTemp5
				</a>
			</p>
		</div><!-- search-box -->
		<div class="menu-bar">
			<ul>
				<li>
					<a href="index.html">Home</a>
				</li>
				<li>
					<a href="category.html">Menu</a>
					<ul>
						<li><a href="category.html"> Sub Menu</a></li>
						<li><a href="category.html"> Sub Menu</a></li>
						<li><a href="category.html"> Sub Menu</a></li>
						<li><a href="category.html"> Sub Menu</a></li>
					</ul>
				</li>
				<li>
					<a class="noti no-hover">Cart</a>
				</li>
			</ul>
		</div><!-- menu-bar -->
	</div><!-- top-nav-bar -->
    <div class="shopping-cart no-display">
        <div class="title">
            Shopping Bag
        </div>
        <div>
            <div class="all-cart">
                <ul id="show-cart">
					
                </ul>
                <p>
                    Total:&nbsp;$
                    <span id="total-cart">
                    </span>
                </p>

                <button id="clear-cart">Clear Cart</button>
            </div><!-- all-cart -->
        </div>
    </div><!-- shopping-cart -->
	<section class="header">
		<div class="column-100">
		  <form>
			  <div class="column-50">
				  <h3>Billing Address</h3>
				  <label for="fname"><i class="fa fa-user"></i> Full Name</label>
				  <input type="text" id="fname" name="firstname" placeholder="John Smith">
				  <label for="email"><i class="fa fa-envelope"></i> Email</label>
				  <input type="text" id="email" name="email" placeholder="johnsmith@example.com">
				  <label for="adr"><i class="fa fa-address-card-o"></i> Address</label>
				  <input type="text" id="adr" name="address" placeholder="123 Name Street">
				  <label for="city"><i class="fa fa-institution"></i> City</label>
				  <input type="text" id="city" name="city" placeholder="City">
				  <label for="state">State</label>
				  <input type="text" id="state" name="state" placeholder="State">
				  <label for="zip">Zip</label>
				  <input type="text" id="zip" name="zip" placeholder="1234">
			  </div><!-- column-50 -->
			  <div class="column-50">
				  <h3>Payment</h3>
				  <label for="cname">Name on Card</label>
				  <input type="text" id="cname" name="cardname" placeholder="John Smith">
				  <label for="ccnum">Credit card number</label>
				  <input type="text" id="ccnum" name="cardnumber" placeholder="9999-8888-7777-6666">
				  <label for="expmonth">Exp Month</label>
				  <input type="text" id="expmonth" name="expmonth" placeholder="January">
				  <label for="expyear">Exp Year</label>
				  <input type="text" id="expyear" name="expyear" placeholder="2020">
				  <label for="cvv">CVV</label>
				  <input type="text" id="cvv" name="cvv" placeholder="987">
			  </div><!-- column-50 -->
			<label>
			  	<span>
					<input type="checkbox" checked="checked" name="sameadr"> 
					Shipping address same as billing
				</span>
			</label>
			<input type="submit" value="Continue to checkout" class="btn">
		  </form>
		</div>
	</section><!-- header -->
	<footer>
		<div class="container text-center">
			<p>
				<a href="https://datazul.info/">
					back to datazul
				</a>
			</p>
		</div><!-- container text-center -->
	</footer>
</body>
</html>
<script>
//                var swiper = new Swiper('.swiper-container', {
//                    slidesPerView: 1,
//                    spaceBetween: 30,
//                    pagination: {
//                      clickable: true,
//                    },
//                    breakpoints: {
//                      980: {
//                        slidesPerView: 3,
//                        spaceBetween: 10
//                      }
//                    }
//                });
		
				var noti = document.querySelector('.noti');
				var select = document.querySelector(".shopping-cart");
				var button = document.getElementsByClassName("btn-primary");
				for(but of button)
				{
					but.addEventListener('click', (e)=>{
						var add = Number(noti.getAttribute('data-count')|| 0);
						noti.setAttribute('data-count', add + 1);
						noti.classList.add('zero');
					})
				}
				
				$('.noti').click(function() {
					if($('.shopping-cart').hasClass('no-display')){
					   	$('.shopping-cart').removeClass('no-display');
						$('.shopping-cart').addClass('display');
					} else {
						$('.shopping-cart').removeClass('display');
						$('.shopping-cart').addClass('no-display');
					}
				});
				
				$(".add-to-cart").click(function(event){
					event.preventDefault();
					var name = $(this).attr("data-name");
					var price = Number($(this).attr("data-price"));
					
					
					addItemToCart(name,price,1);
					displayCart();
				});
				
				$("#clear-cart").click(function(event){
					clearCart();
					displayCart();
					noti.removeAttribute('data-count');
					noti.classList.remove('zero');
				});
				
				function displayCart(){
					var cartArray = listCart();
					var output = "";
					for(var i in cartArray) {
						output += 
							"<li><button class='delete-item' data-name='"
							+cartArray[i].name+"'>Remove</button>"
							+cartArray[i].name+" x "
							+"<span class='hello' data-count='"+cartArray[i].count+"'>"
							+cartArray[i].count+"</span>"
							+"$"+cartArray[i].total
							+"</li>";
					}
					
					$("#show-cart").html(output);
					$("#total-cart").html(totalCart());	
				}
				
                $("#show-cart").on("click", ".delete-item",function(event){
					var name = $(this).attr("data-name");
					var subtract = Number(noti.getAttribute('data-count'));
					var hello = document.querySelector('.hello');
					var test = Number(hello.getAttribute('data-count'));
					noti.setAttribute('data-count', subtract - test);
					if((noti.getAttribute('data-count') == 0)){
						noti.removeAttribute('data-count');
						noti.classList.remove('zero');
					 }
					removeItemFromCartAll(name);
					displayCart();
                });
				
//                $("#show-cart").on("click", ".subtract-item",function(event){
//					var name = $(this).attr("data-name");
//					removeItemFromCart(name);
//					displayCart();
//                });		
//				
//                $("#show-cart").on("click", ".plus-item",function(event){
//					var name = $(this).attr("data-name");
//					addItemToCart(name,0,1);
//					displayCart();
//                });		
				
// --------------------------------------------------------------------------------- //
				var cart = [];
				
				var Item = function(name, price, count){
					this.name = name
					this.price = price
					this.count = count
				}
				
				
				function addItemToCart(name, price, count){
					for(var i in cart){
						if(cart[i].name === name){
							cart[i].count += count;
							saveCart();
							return;
						}
					}
					var item = new Item(name, price, count);
					cart.push(item);
					saveCart();
				}
				
				
//				addItemToCart("ProductName1", 100.21, 1);
//				addItemToCart("ProductName2", 200.22, 1);
//				addItemToCart("ProductName3", 300.23, 1);
//				addItemToCart("ProductName4", 400.24, 1);
				
				function removeItemFromCart(name){
					for(var i in cart){
						if(cart[i].name === name){
							cart[i].count --;
							if(cart[i].count === 0){
								cart.splice(i, 1);
							}
							break;
						}
					}
					saveCart();
				}
				
				function removeItemFromCartAll(name){
					for(var i in cart){
						if(cart[i].name === name){
							cart.splice(i, 1);
							break;
						}
					}
					saveCart();
				}
				
				function clearCart(){
					cart = [];

					saveCart();
				}
				
				function countCart(){
					var totalCount = 0;
					for(var i in cart){
						totalCount += cart[i].count;
					}
					
					return totalCount;
				}
				
				function totalCart(){
					var totalCost = 0;
					for(var i in cart){
						totalCost += cart[i].price * cart[i].count;
					}
					return totalCost.toFixed(2);
				}
				
				function listCart(){
					var cartCopy = [];
					for(var i in cart){
						var item = cart[i];
						var itemCopy = {};
						for(var p in item){
							itemCopy[p] = item[p];
						}
						itemCopy.total = (item.price * item.count).toFixed(2);
						cartCopy.push(itemCopy);
					}
					return cartCopy;
				}
				
				function saveCart(){
					localStorage.setItem("ShoppingCart", JSON.stringify(cart));
				}
				
				function loadCart(){
					cart = JSON.parse(localStorage.getItem("ShoppingCart"));
				}
				
				loadCart();
				displayCart();
</script>