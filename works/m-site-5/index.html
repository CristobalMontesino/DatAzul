<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>WebTemplate5</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="css/stylesheet.css">
	<link rel="stylesheet" href="css/responsive.css">
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/swiper-bundle.min.css">
	<script type="text/javascript" src="js/jquery-3.5.1.slim.min.js"></script>
	<script type="text/javascript" src="js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/swiper-bundle.min.js"></script>
</head>

<body>
	<div id="top" class="top-nav-bar">
		<div class="search-box text-center">
			<p>
				<a href="#top">
					WebTemp5
				</a>
			</p>
		</div><!-- search-box -->
		<div class="menu-bar">
			<ul>
				<li>
					<a href="index.html">Home</a>
				</li>
				<li>
					<a href="category.html">Menu</a>
					<ul>
						<li><a href="category.html"> Sub Menu</a></li>
						<li><a href="category.html"> Sub Menu</a></li>
						<li><a href="category.html"> Sub Menu</a></li>
						<li><a href="category.html"> Sub Menu</a></li>
					</ul>
				</li>
				<li>
					<a class="noti no-hover">Cart</a>
				</li>
			</ul>
		</div><!-- menu-bar -->
	</div><!-- top-nav-bar -->
    <div class="shopping-cart no-display">
        <div class="title">
            Shopping Bag
        </div>
        <div>
            <div class="all-cart">
                <ul id="show-cart">
					
                </ul>
                <p>
                    Total:&nbsp;$
                    <span id="total-cart">
                    </span>
                </p>

                <button id="clear-cart">Clear Cart</button>
				<a class="payment-button" href="payment.html">Go To Payment</a>
            </div><!-- all-cart -->
        </div>
    </div><!-- shopping-cart -->
	<section class="header">
		<div class="slider">
			<div id="slider" class="carousel slide carousel-fade" data-ride="carousel">
				<div class="carousel-inner">
					<div class="carousel-item active">
					  <a href="product.html"><img src="img/foto-1.jpg" class="d-block w-100" alt="foto-1" /></a>
					</div>
					<div class="carousel-item">
					  <a href="product.html"><img src="img/foto-2.jpg" class="d-block w-100" alt="foto-2" /></a>
					</div>
					<div class="carousel-item">
					  <a href="product.html"><img src="img/foto-3.jpg" class="d-block w-100" alt="foto-3" /></a>
					</div>
					<div class="carousel-item">
					  <a href="product.html"><img src="img/foto-4.JPG" class="d-block w-100" alt="foto-4" /></a>
					</div>
				</div><!-- carousel-inner -->
                <ol class="carousel-indicators">
					<li data-target="#slider" data-slide-to="0" class="active"></li>
					<li data-target="#slider" data-slide-to="1"></li>
					<li data-target="#slider" data-slide-to="2"></li>
					<li data-target="#slider" data-slide-to="3"></li>
                </ol><!-- carousel-indicators -->
			</div><!-- carousel slide carousel-fade -->
		</div><!-- slider -->
	</section>
	<!----- featured-categories ------->
	<section class="featured-categories">
		<div class="title-box">
			<p>title box</p>
		</div>
		<!-- swipe container -->
		<div class="swiper-container">
			<div class="swiper-wrapper">
				<div class="swiper-slide col-md-4">
					<a href="category.html">
						<p class="letter-title">category title</p>
						<img src="img/foto-1.jpg" width="100%" height="auto" alt="foto-1" />
					</a>
				</div><!-- col-md-4 -->
				<div class="swiper-slide col-md-4">
					<a href="category.html">
						<p class="letter-title">category title</p>
						<img src="img/foto-2.jpg" width="100%" height="auto" alt="foto-1" />
					</a>
				</div><!-- col-md-4 -->
				<div class="swiper-slide col-md-4">
					<a href="category.html">
						<p class="letter-title">category title</p>
						<img src="img/foto-3.jpg" width="100%" height="auto" alt="foto-1" />
					</a>
				</div><!-- col-md-4 -->
				<div class="swiper-slide col-md-4">
					<a href="category.html">
						<p class="letter-title">category title</p>
						<img src="img/foto-4.JPG" width="100%" height="auto" alt="foto-4" />
					</a>
				</div><!-- col-md-4 -->
				<div class="swiper-slide col-md-4">
					<a href="category.html">
						<p class="letter-title">category title</p>
						<img src="img/foto-1.jpg" width="100%" height="auto" alt="foto-1" />
					</a>
				</div><!-- col-md-4 -->
				<div class="swiper-slide col-md-4">
					<a href="category.html">
						<p class="letter-title">category title</p>
						<img src="img/foto-2.jpg" width="100%" height="auto" alt="foto-1" />
					</a>
				</div><!-- col-md-4 -->
				<div class="swiper-slide col-md-4">
					<a href="category.html">
						<p class="letter-title">category title</p>
						<img src="img/foto-3.jpg" width="100%" height="auto" alt="foto-1" />
					</a>
				</div><!-- col-md-4 -->
				<div class="swiper-slide col-md-4">
					<a href="category.html">
						<p class="letter-title">category title</p>
						<img src="img/foto-4.JPG" width="100%" height="auto" alt="foto-4" />
					</a>
				</div><!-- col-md-4 -->
			</div><!-- swipe-wrapper -->
		</div><!-- swiper-container -->
		<div class="title-box">
			<p>title box</p>
		</div>
		<!-- swipe container -->
		<div class="swiper-container">
			<div class="swiper-wrapper">
				<div class="swiper-slide col-md-4">
					<a href="product.html">
						<p class="letter-title">product title</p>
							<img src="img/foto-1.jpg" width="100%" height="auto" alt="foto-1" />
						<p class="number-price">$00.00</p>
					</a>
				</div><!-- col-md-4 -->
				<div class="swiper-slide col-md-4">
					<a href="product.html">
						<p class="letter-title">product title</p>
							<img src="img/foto-2.jpg" width="100%" height="auto" alt="foto-1" />
						<p class="number-price">$00.00</p>
					</a>
				</div><!-- col-md-4 -->
				<div class="swiper-slide col-md-4">
					<a href="product.html">
						<p class="letter-title">product title</p>
							<img src="img/foto-3.jpg" width="100%" height="auto" alt="foto-1" />
						<p class="number-price">$00.00</p>
					</a>
				</div><!-- col-md-4 -->
				<div class="swiper-slide col-md-4">
					<a href="product.html">
						<p class="letter-title">product title</p>
							<img src="img/foto-4.JPG" width="100%" height="auto" alt="foto-4" />
						<p class="number-price">$00.00</p>
					</a>
				</div><!-- col-md-4 -->
				<div class="swiper-slide col-md-4">
					<a href="product.html">
						<p class="letter-title">product title</p>
							<img src="img/foto-1.jpg" width="100%" height="auto" alt="foto-1" />
						<p class="number-price">$00.00</p>
					</a>
				</div><!-- col-md-4 -->
				<div class="swiper-slide col-md-4">
					<a href="product.html">
						<p class="letter-title">product title</p>
							<img src="img/foto-2.jpg" width="100%" height="auto" alt="foto-1" />
						<p class="number-price">$00.00</p>
					</a>
				</div><!-- col-md-4 -->
				<div class="swiper-slide col-md-4">
					<a href="product.html">
						<p class="letter-title">product title</p>
							<img src="img/foto-3.jpg" width="100%" height="auto" alt="foto-1" />
						<p class="number-price">$00.00</p>
					</a>
				</div><!-- col-md-4 -->
				<div class="swiper-slide col-md-4">
					<a href="product.html">
						<p class="letter-title">product title</p>
							<img src="img/foto-4.JPG" width="100%" height="auto" alt="foto-4" />
						<p class="number-price">$00.00</p>
					</a>
				</div><!-- col-md-4 -->
			</div><!-- swipe-wrapper -->
		</div><!-- swiper-contaicategory -->
	</section><!-- featured-categories -->
	<footer>
		<div class="container text-center">
			<p>
				<a href="https://datazul.info/">
					back to datazul
				</a>
			</p>
		</div><!-- container text-center -->
	</footer>
	<script>
                var swiper = new Swiper('.swiper-container', {
                    slidesPerView: 1,
                    spaceBetween: 30,
                    pagination: {
                      clickable: true,
                    },
                    breakpoints: {
                      980: {
                        slidesPerView: 3,
                        spaceBetween: 10
                      }
                    }
                });
		
				var noti = document.querySelector('.noti');
				var select = document.querySelector(".shopping-cart");
				var button = document.getElementsByClassName("btn-primary");
				for(but of button)
				{
					but.addEventListener('click', (e)=>{
						var add = Number(noti.getAttribute('data-count')|| 0);
						noti.setAttribute('data-count', add + 1);
						noti.classList.add('zero');
					})
				}
				
				$('.noti').click(function() {
					if($('.shopping-cart').hasClass('no-display')){
					   	$('.shopping-cart').removeClass('no-display');
						$('.shopping-cart').addClass('display');
					} else {
						$('.shopping-cart').removeClass('display');
						$('.shopping-cart').addClass('no-display');
					}
				});
				
				$(".add-to-cart").click(function(event){
					event.preventDefault();
					var name = $(this).attr("data-name");
					var price = Number($(this).attr("data-price"));
					
					
					addItemToCart(name,price,1);
					displayCart();
				});
				
				$("#clear-cart").click(function(event){
					clearCart();
					displayCart();
					noti.removeAttribute('data-count');
					noti.classList.remove('zero');
				});
				
				function displayCart(){
					var cartArray = listCart();
					var output = "";
					for(var i in cartArray) {
						output += 
							"<li><button class='delete-item' data-name='"
							+cartArray[i].name+"'>Remove</button>"
							+cartArray[i].name+" x "
							+"<span class='hello' data-count='"+cartArray[i].count+"'>"
							+cartArray[i].count+"</span>"
							+"$"+cartArray[i].total
							+"</li>";
					}
					
					$("#show-cart").html(output);
					$("#total-cart").html(totalCart());	
				}
				
                $("#show-cart").on("click", ".delete-item",function(event){
					var name = $(this).attr("data-name");
					var subtract = Number(noti.getAttribute('data-count'));
					var hello = document.querySelector('.hello');
					var test = Number(hello.getAttribute('data-count'));
					noti.setAttribute('data-count', subtract - test);
					if((noti.getAttribute('data-count') == 0)){
						noti.removeAttribute('data-count');
						noti.classList.remove('zero');
					 }
					removeItemFromCartAll(name);
					displayCart();
                });
				
//                $("#show-cart").on("click", ".subtract-item",function(event){
//					var name = $(this).attr("data-name");
//					removeItemFromCart(name);
//					displayCart();
//                });		
//				
//                $("#show-cart").on("click", ".plus-item",function(event){
//					var name = $(this).attr("data-name");
//					addItemToCart(name,0,1);
//					displayCart();
//                });		
				
// --------------------------------------------------------------------------------- //
				var cart = [];
				
				var Item = function(name, price, count){
					this.name = name
					this.price = price
					this.count = count
				}
				
				
				function addItemToCart(name, price, count){
					for(var i in cart){
						if(cart[i].name === name){
							cart[i].count += count;
							saveCart();
							return;
						}
					}
					var item = new Item(name, price, count);
					cart.push(item);
					saveCart();
				}
				
				
//				addItemToCart("ProductName1", 100.21, 1);
//				addItemToCart("ProductName2", 200.22, 1);
//				addItemToCart("ProductName3", 300.23, 1);
//				addItemToCart("ProductName4", 400.24, 1);
				
				function removeItemFromCart(name){
					for(var i in cart){
						if(cart[i].name === name){
							cart[i].count --;
							if(cart[i].count === 0){
								cart.splice(i, 1);
							}
							break;
						}
					}
					saveCart();
				}
				
				function removeItemFromCartAll(name){
					for(var i in cart){
						if(cart[i].name === name){
							cart.splice(i, 1);
							break;
						}
					}
					saveCart();
				}
				
				function clearCart(){
					cart = [];
					saveCart();
				}
				
				function countCart(){
					var totalCount = 0;
					for(var i in cart){
						totalCount += cart[i].count;
					}
					
					return totalCount;
				}
				
				function totalCart(){
					var totalCost = 0;
					for(var i in cart){
						totalCost += cart[i].price * cart[i].count;
					}
					return totalCost.toFixed(2);
				}
				
				function listCart(){
					var cartCopy = [];
					for(var i in cart){
						var item = cart[i];
						var itemCopy = {};
						for(var p in item){
							itemCopy[p] = item[p];
						}
						itemCopy.total = (item.price * item.count).toFixed(2);
						cartCopy.push(itemCopy);
					}
					return cartCopy;
				}
				
				function saveCart(){
					localStorage.setItem("ShoppingCart", JSON.stringify(cart));
				}
				
				function loadCart(){
					cart = JSON.parse(localStorage.getItem("ShoppingCart"));
				}
				
				loadCart();
				displayCart();
	</script>
</body>
</html>
